import{r as e,j as a,p as t,P as l,q as s,s as r,t as i,v as n,e as o}from"./index-epAGByur.js";import{m as c}from"./proxy-DCvGezJ2.js";import"./vendor-MJHYApCa.js";const d="/assets/cover-CpnmKAbv.jpg";function u(){const[u,p]=e.useState(null),[h,m]=e.useState(null),[x,g]=e.useState(!0),[j,v]=e.useState(null),[f,b]=e.useState(null),[N,y]=e.useState(!1),[C,k]=e.useState(null),[S,w]=e.useState(""),[I,F]=e.useState(""),[z,A]=e.useState(""),[E,U]=e.useState(""),[B,$]=e.useState(""),[D,G]=e.useState(""),[L,M]=e.useState(""),[T,O]=e.useState(""),[P,R]=e.useState(""),[q,H]=e.useState(""),[K,J]=e.useState(""),[Q,V]=e.useState([]),[W,X]=e.useState([]),[Y,Z]=e.useState(!1),[_,ee]=e.useState({linkedin:"",github:"",twitter:""});e.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token"),a=await o.get("https://padel-hnj9.onrender.com/api/profile",{headers:{Authorization:`Bearer ${e}`}});m(a.data.user)}catch(e){}finally{g(!1)}})()}),[]),e.useEffect((()=>{var e,a,t,l,s;h&&(w(h.name||""),F(h.email||""),A(h.AboutMe||""),U((null==(e=h.birthday)?void 0:e.split("T")[0])||""),$(h.phoneNumber||""),G(h.gender||""),M(h.country||""),X(h.occupation||[]),R((null==(a=h.GeneralInfo)?void 0:a.Education)||""),H((null==(t=h.GeneralInfo)?void 0:t.workExperience)||""),V((null==(l=h.GeneralInfo)?void 0:l.skills)||[]),ee((null==(s=h.GeneralInfo)?void 0:s.socialMedia)||{linkedin:"",github:"",twitter:""}))}),[h]);const ae=e=>{e.preventDefault(),k(e.target.src)};return x?a.jsx("div",{className:"loading-center-container-profile-main",children:a.jsx("div",{className:"spinner-border-main-profile"})}):j?a.jsx("div",{className:"error-message-editing-profile",children:j}):a.jsxs("div",{className:"profile-container-main",children:[a.jsxs("div",{className:"cover-section-container",children:[a.jsxs("div",{className:"cover-upload-container",children:[a.jsxs("label",{htmlFor:"coverUpload",className:"upload-label",children:[a.jsx(t,{style:{color:"green"}}),a.jsx("input",{type:"file",id:"coverUpload",onChange:e=>p(e.target.files[0]),hidden:!0})]}),a.jsx("button",{className:"modern-button",onClick:async()=>{if(!u)return v("No cover image selected");const e=new FormData;e.append("coverImage",u);try{const a=localStorage.getItem("token"),t=await o.post("https://padel-hnj9.onrender.com/api/profile/cover-picture",e,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"multipart/form-data"}});m(t.data.user)}catch(a){v("Failed to upload cover image")}},disabled:!u,children:u?"حفظ الصورة":"تحميل الصورة"}),a.jsx("button",{className:"modern-button-delete",onClick:async()=>{try{const e=localStorage.getItem("token"),a=await o.delete("https://padel-hnj9.onrender.com/api/profile/cover-picture",{headers:{Authorization:`Bearer ${e}`}});m(a.data.user)}catch(e){v("Failed to delete cover image")}},hidden:!(null==h?void 0:h.coverImage),children:"حذف الصورة"})]}),a.jsx("img",{src:(null==h?void 0:h.coverImage)?h.coverImage:u?URL.createObjectURL(u):d,alt:"Cover",loading:"lazy",onClick:ae,className:"cover-image",onError:e=>e.target.src=d})]}),a.jsxs("div",{id:"profile",children:[a.jsxs("div",{className:"profile-image-section",children:[a.jsx("img",{src:(null==h?void 0:h.profileImage)?h.profileImage:f?URL.createObjectURL(f):l,alt:"Profile",loading:"lazy",onClick:ae,className:"profile-image",onError:e=>e.target.src=l}),C&&a.jsx("div",{className:"modal-image-container",onClick:()=>{k(null)},children:a.jsx("img",{src:C,alt:"Preview",loading:"lazy"})}),a.jsxs("div",{className:"profile-upload-container",children:[a.jsxs("label",{htmlFor:"profileUpload",className:"upload-label",hidden:null==h?void 0:h.profileImage,children:[a.jsx(t,{style:{color:"green"}}),a.jsx("input",{type:"file",id:"profileUpload",onChange:e=>b(e.target.files[0]),hidden:!0})]}),a.jsx("button",{className:"modern-button",onClick:async()=>{if(!f)return v("No file selected");const e=new FormData;e.append("profileImage",f);try{const a=localStorage.getItem("token"),t=await o.post("https://padel-hnj9.onrender.com/api/profile/picture",e,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"multipart/form-data"}});m(t.data.user)}catch(a){v("Failed to upload profile image")}},disabled:!f,children:f?"حفظ الصورة":"تحميل الصورة"}),a.jsx("button",{hidden:!(null==h?void 0:h.profileImage),className:"modern-button-delete",onClick:async()=>{try{const e=localStorage.getItem("token"),a=await o.delete("https://padel-hnj9.onrender.com/api/profile/picture",{headers:{Authorization:`Bearer ${e}`}});m(a.data.user)}catch(e){v("Failed to delete profile image")}},children:"حذف الصورة"})]})]}),a.jsx("div",{className:"edit-form",children:a.jsxs("section",{className:"form-section",children:[a.jsxs("h2",{children:[a.jsx(s,{})," بيانات شخصية"]}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"الاسم الكامل"}),a.jsx("input",{type:"text",value:S,onChange:e=>w(e.target.value)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ألايميل"}),a.jsx("input",{type:"email",value:I,onChange:e=>F(e.target.value)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"تاريخ الميلاد"}),a.jsx("input",{type:"date",value:E,onChange:e=>U(e.target.value)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"رقم الجوال"}),a.jsx("input",{type:"tel",value:B,placeholder:"01012345678",onChange:e=>$(e.target.value)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"النوع"}),a.jsxs("select",{value:D,onChange:e=>G(e.target.value),children:[a.jsx("option",{value:"",children:"أختر"}),a.jsx("option",{value:"Male",children:"ذكر"}),a.jsx("option",{value:"Female",children:"انثى"}),a.jsx("option",{value:"Other",children:"اخر"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"البلد"}),a.jsx("input",{type:"text",value:L,placeholder:"اسم البلد",onChange:e=>M(e.target.value)})]})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{children:"المهنة"}),a.jsxs("div",{className:"input-with-button",children:[a.jsx("input",{type:"text",value:T,onChange:e=>O(e.target.value),placeholder:"أضف مهنة"}),a.jsx("button",{className:"modern-button",onClick:e=>{e.preventDefault(),T.trim()&&!W.includes(T.trim())&&(X([...W,T.trim()]),O(""))},children:"أضف"})]}),a.jsx("ul",{className:"tag-list",children:W.map(((e,t)=>a.jsxs("li",{className:"tag-item",children:[e,a.jsx("button",{className:"delete-tag",onClick:()=>{return a=e,void X(W.filter((e=>e!==a)));var a},children:"×"})]},t)))})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{children:"المهارات"}),a.jsxs("div",{className:"input-with-button",children:[a.jsx("input",{type:"text",value:K,onChange:e=>J(e.target.value),placeholder:"أضف مهارة"}),a.jsx("button",{className:"modern-button",onClick:e=>{e.preventDefault(),K.trim()&&!Q.includes(K.trim())&&(V([...Q,K.trim()]),J(""))},children:"أضف"})]}),a.jsx("ul",{className:"tag-list",children:Q.map(((e,t)=>a.jsxs("li",{className:"tag-item",children:[e,a.jsx("button",{className:"delete-tag",onClick:()=>{return a=e,void V(Q.filter((e=>e!==a)));var a},children:"×"})]},t)))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"نبذة"}),a.jsx("textarea",{value:z,onChange:e=>A(e.target.value),rows:"4",placeholder:"نبذة عنك"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"التعليم"}),a.jsx("input",{type:"text",value:P,placeholder:"التعليم",onChange:e=>R(e.target.value)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"خبرات العمل"}),a.jsx("textarea",{placeholder:"خبرات العمل",value:q,onChange:e=>H(e.target.value),rows:"4"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"مواقع التواصل"}),a.jsxs("div",{className:"social-inputs",children:[a.jsx("input",{type:"text",placeholder:"LinkedIn",value:_.linkedin,onChange:e=>ee({..._,linkedin:e.target.value})}),a.jsx("input",{type:"text",placeholder:"GitHub",value:_.github,onChange:e=>ee({..._,github:e.target.value})}),a.jsx("input",{type:"text",placeholder:"Twitter",value:_.twitter,onChange:e=>ee({..._,twitter:e.target.value})})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{onClick:async()=>{y(!0);try{const e=localStorage.getItem("token"),a={};S&&(a.name=S),I&&(a.email=I),E&&(a.birthday=E),B&&(a.phoneNumber=B),D&&(a.gender=D),L&&(a.country=L),a.occupation=W,a.skills=Q,z&&(a.AboutMe=z),P&&(a.Education=P),q&&(a.workExperience=q),_&&Object.keys(_).length>0&&(a.socialMedia=_),await o.put("https://padel-hnj9.onrender.com/api/user/updatePersonalInfo",a,{headers:{Authorization:`Bearer ${e}`}}),Z(!0),setTimeout((()=>Z(!1)),3e3)}catch(e){v("Failed to update profile")}finally{y(!1)}},disabled:N,className:"save-button-profile",children:N?a.jsx(c.span,{animate:{rotate:360},transition:{duration:1,repeat:1/0},children:a.jsx(r,{})}):a.jsxs("div",{className:"save-button-text",children:[a.jsx(i,{}),a.jsx("span",{children:"حفظ التغييرات"})]})}),Y&&a.jsxs("span",{className:"success-message",children:[a.jsx(n,{})," تم حفظ التغييرات"]})]})]})})]})]})}export{u as default};
