import{r as e,j as s,I as a,a as t,P as l,F as r,b as i,c as n,d as o,L as c,e as d,G as m,f as p,g as h,h as u,i as j,k as x,l as g,R as N,S as v,m as f,n as y,N as b,o as k}from"./index-epAGByur.js";import{s as S}from"./message-BbX-ItwN.js";import{M as _}from"./index-EzTomcpk.js";import"./vendor-MJHYApCa.js";function I(){const[m,p]=e.useState({}),[h,u]=e.useState([]),[j,x]=e.useState(!1),[g,N]=e.useState(5),[v,f]=e.useState(!0),[y,b]=e.useState(!1),[k,S]=e.useState(1),[_,I]=e.useState(""),[w,C]=e.useState({profile:!0,skills:!0,friends:!0});e.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await d.get("https://padel-hnj9.onrender.com/api/profileUser",{headers:{Authorization:`Bearer ${e}`}});p(s.data.user)}catch(e){I("ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…")}})()}),[]),e.useEffect((()=>{(async()=>{b(!0);try{const e=localStorage.getItem("token"),s=await d.get(`https://padel-hnj9.onrender.com/api/get-friends-users?limit=4&page=${k}`,{headers:{Authorization:`Bearer ${e}`}});u((e=>[...e,...s.data.friends])),f(s.data.hasMore)}catch(e){I("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡.")}finally{b(!1)}})()}),[k]);const $=()=>x(!j),z=e=>{C((s=>({...s,[e]:!s[e]})))};return s.jsx("div",{className:"sidebar-container",children:s.jsx("div",{className:"sidebar",children:s.jsx("div",{className:"sidebar-header",children:s.jsxs("div",{className:"sidebar-profile-details",children:[s.jsxs("div",{className:"sidebar-section "+(w.profile?"expanded":""),children:[s.jsxs("div",{className:"section-header",onClick:()=>z("profile"),children:[s.jsx("h3",{children:"Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ"}),w.profile?s.jsx(a,{}):s.jsx(t,{})]}),w.profile&&s.jsxs("div",{className:"sidebar-profile",children:[s.jsxs("div",{className:"profile-image-container",children:[s.jsx("img",{className:"sidebar-profile-img",onClick:$,src:m.profileImage||l,alt:"Profile",loading:"lazy",onError:e=>e.target.src=l}),s.jsx("div",{className:"profile-status"})]}),j&&s.jsx("div",{className:"profile-is-open",children:s.jsxs("div",{className:"profile-modal",children:[s.jsx("img",{className:"profile-is-open-img",src:m.profileImage||l,alt:"Profile",onError:e=>e.target.src=l}),s.jsx("button",{className:"profile-is-open-close",onClick:$,children:s.jsx(r,{})})]})}),s.jsxs("div",{className:"profile-info",children:[s.jsx("h4",{children:m.name||"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"}),s.jsx("div",{className:"profile-meta",children:s.jsxs("span",{className:"meta-item",children:[s.jsx(i,{className:"meta-icon"}),s.jsx("span",{children:m.Education||"Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ…"})]})}),s.jsxs("div",{className:"profile-roles",children:[s.jsx("div",{className:"role-badge",children:s.jsx("span",{children:"user"===m.role?"Ù…Ø³ØªØ®Ø¯Ù…":m.role})}),s.jsxs("div",{className:"job-badge",children:[s.jsx(n,{className:"job-icon"}),s.jsx("span",{children:Array.isArray(m.occupation)&&m.occupation.length>0?m.occupation[0]:"Ù„Ø§ ÙŠÙˆØ¬Ø¯"})]})]})]})]})]}),s.jsxs("div",{className:"sidebar-section "+(w.skills?"expanded":""),children:[s.jsxs("div",{className:"section-header",onClick:()=>z("skills"),children:[s.jsx("h3",{children:"Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª"}),w.skills?s.jsx(a,{}):s.jsx(t,{})]}),w.skills&&s.jsx("div",{className:"sidebar-profile-skills",children:s.jsx("div",{className:"skills-grid",children:Array.isArray(m.skills)&&m.skills.length>0?m.skills.slice(0,3).map(((e,a)=>s.jsx("div",{className:"skill-badge",children:e},a))):s.jsx("p",{className:"no-skills",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ø±Ø§Øª Ù…Ø¶Ø§ÙØ©"})})})]}),s.jsxs("div",{className:"sidebar-section "+(w.friends?"expanded":""),children:[s.jsxs("div",{className:"section-header",onClick:()=>z("friends"),children:[s.jsxs("h3",{children:[s.jsx(o,{className:"friends-icon"})," Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø²Ù…Ù„Ø§Ø¡"]}),w.friends?s.jsx(a,{}):s.jsx(t,{})]}),w.friends&&s.jsxs("div",{className:"sidebar-profile-links",children:[_&&s.jsx("p",{className:"error-message",children:_}),s.jsxs("div",{className:"friend-profile-Sidebar",children:[Array.isArray(h)&&h.length>0?h.slice(0,g).map((e=>s.jsxs("div",{className:"friend-profile-item-Sidebar-home",children:[s.jsx("div",{className:"friend-avatar",children:s.jsx("img",{src:e.profileImage||l,alt:e.name,onError:e=>e.target.src=l,loading:"lazy"})}),s.jsx(c,{to:`/@!users/${e._id}`,className:"friend-name",children:e.name}),s.jsx("span",{className:"friend-status"})]},e._id))):s.jsx("p",{className:"no-friends-sidebar",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£ØµØ¯Ù‚Ø§Ø¡ Ù„Ø¹Ø±Ø¶Ù‡Ù…."}),(v||g<h.length)&&s.jsx("button",{onClick:()=>{g<h.length?N((e=>e+5)):v&&!y&&S((e=>e+1))},className:"show-more-btn-sidebar",children:y?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯"})]})]})]})]})})})})}function w(e){return m({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M14 6V4h-4v2h4zM4 8v11h16V8H4zm16-2c1.11 0 2 .89 2 2v11c0 1.11-.89 2-2 2H4c-1.11 0-2-.89-2-2l.01-11c0-1.11.88-2 1.99-2h4V4c0-1.11.89-2 2-2h4c1.11 0 2 .89 2 2v2h4z"},child:[]}]})(e)}p.extend(x),p.locale("ar");const C=()=>{var a;const[t,l]=e.useState([]),[i,n]=e.useState(!0),[o,m]=e.useState(null),[x,g]=e.useState(null),N=localStorage.getItem("token");return e.useEffect((()=>{(async()=>{try{const e=await d.get("https://padel-hnj9.onrender.com/api/get-public-projects-home?limit=3&page=1",{headers:{Authorization:`Bearer ${N}`}});l(e.data.publicProjects||[])}catch{m("ÙˆØ§Ø¬Ù‡Ù†Ø§ Ù…Ø´ÙƒÙ„Ø© Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹.")}finally{n(!1)}})()}),[]),i?s.jsxs("div",{className:"pjh-loading",children:[s.jsx("div",{className:"pjh-spinner"}),s.jsx("p",{children:"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹..."})]}):o?s.jsx("p",{className:"pjh-error",children:o}):s.jsxs("main",{className:"pjh-main",children:[s.jsx("div",{className:"pjh-header",children:s.jsx("h2",{children:"Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©"})}),0===t.length?s.jsxs("div",{className:"pjh-empty-container",children:[s.jsx("div",{className:"pjh-empty-illustration",children:s.jsx(w,{className:"pjh-empty-icon"})}),s.jsx("p",{className:"pjh-empty",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."}),s.jsx(c,{to:"/@!Jointprojects",className:"pjh-explore-btn",children:"Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹"})]}):s.jsxs(s.Fragment,{children:[s.jsx("section",{className:"pjh-grid",children:t.map((e=>s.jsxs("article",{className:"pjh-card",onClick:()=>g(e),children:[s.jsxs("div",{className:"pjh-card-header",children:[s.jsx("div",{className:"pjh-image-wrapper",children:e.ImgProjects?s.jsx("img",{src:e.ImgProjects,alt:e.projectName||"Ù…Ø´Ø±ÙˆØ¹",className:"pjh-image",loading:"lazy"}):s.jsx("div",{className:"pjh-no-image",children:s.jsx(w,{className:"no-image-icon"})})}),s.jsx("div",{className:"pjh-card-badges",children:s.jsxs("span",{className:"pjh-badge",children:[s.jsx(h,{className:"badge-icon"}),p(e.createdAt).fromNow()]})})]}),s.jsx("div",{className:"pjh-card-body",children:s.jsx("h3",{className:"pjh-title",children:e.projectName||"Ø§Ø³Ù… ØºÙŠØ± Ù…ØªÙˆÙØ±"})}),s.jsx("div",{className:"pjh-card-footer",children:s.jsxs("button",{className:"pjh-view-btn",children:[s.jsx(u,{className:"view-icon"}),"Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„"]})})]},e._id)))}),s.jsx("div",{className:"pjh-more-wrapper",children:s.jsxs(c,{to:"/@!Jointprojects",className:"pjh-more-btn",children:["Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ",s.jsx(j,{className:"arrow-icon"})]})})]}),x&&s.jsx("div",{className:"pjh-overlay",onClick:()=>g(null),children:s.jsxs("div",{className:"pjh-modal",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{className:"pjh-close-btn",onClick:()=>g(null),children:s.jsx(r,{})}),s.jsxs("div",{className:"pjh-modal-header",children:[s.jsx("div",{className:"pjh-modal-image-container",children:x.ImgProjects?s.jsx("img",{src:x.ImgProjects,alt:x.projectName,className:"pjh-modal-image",loading:"lazy"}):s.jsx("div",{className:"pjh-modal-no-image",children:s.jsx(w,{className:"modal-no-image-icon"})})}),s.jsxs("div",{className:"pjh-modal-info",children:[s.jsx("h2",{children:x.projectName}),s.jsxs("p",{className:"pjh-modal-date",children:[s.jsx(h,{className:"modal-icon"}),p(x.createdAt).isValid()?p(x.createdAt).format("DD MMMM YYYY"):"ØªØ§Ø±ÙŠØ® ØºÙŠØ± Ù…ØªÙˆÙØ±"]})]})]}),s.jsx("div",{className:"pjh-modal-content",children:(null==(a=x.tags)?void 0:a.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h3",{children:"Ø§Ù„ÙˆØ³ÙˆÙ…"}),s.jsx("div",{className:"pjh-modal-tags",children:x.tags.map(((e,a)=>s.jsx("span",{className:"pjh-modal-tag",children:e},a)))})]})}),s.jsxs("div",{className:"pjh-modal-actions",children:[s.jsx(c,{to:`/projectJoint/${x._id}`,className:"pjh-modal-link",onClick:()=>g(null),children:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ø§Ù„ØªÙØµÙŠÙ„"}),s.jsx("button",{className:"pjh-modal-close",onClick:()=>g(null),children:"Ø¥ØºÙ„Ø§Ù‚"})]})]})})]})},$=({postId:a})=>{const[t,l]=e.useState(null),r=(e=>`${window.location.origin}/post/${e}`)(a);return s.jsx("div",{className:"share-button-container",children:s.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(r),l("success"),setTimeout((()=>l(null)),2e3)}catch{l("error"),setTimeout((()=>l(null)),2e3)}},className:"share-button "+("success"===t?"copied":""),title:"Ø§Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†Ø´ÙˆØ±","aria-live":"polite",children:"success"===t?s.jsx(s.Fragment,{children:"ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·"}):s.jsx(s.Fragment,{children:s.jsx(g,{})})})})};function z(){const[a,t]=e.useState([]),[r,i]=e.useState(!0),n=localStorage.getItem("userId");return e.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token"),{data:s}=await d.get("https://padel-hnj9.onrender.com/api/user-random",{headers:{Authorization:`Bearer ${e}`}});t(s.users)}catch(e){}finally{i(!1)}})()}),[]),r?s.jsx("div",{className:"user-list-Random",children:[...Array(3)].map(((e,a)=>s.jsx("div",{className:"user-item-Random loading-placeholder"},a)))}):s.jsx("div",{className:"user-list-Random",children:a.map((e=>s.jsxs(c,{to:e._id===n?"/@!profile":`/@!users/${e._id}`,className:"user-item-Random",children:[s.jsx("img",{src:(null==e?void 0:e.profileImage)||l,alt:`${(null==e?void 0:e.name)||"user"}'s profile`,className:"user-profile-image-Random",loading:"lazy",onError:e=>e.target.src=l}),s.jsx("h3",{className:"user-name-Random",children:e.name})]},e._id)))})}p.locale("ar"),p.extend(x);const E=({post:a})=>{const[t,r]=e.useState(!1),[i,n]=e.useState({}),[o,m]=e.useState("comments"),[h,u]=e.useState([]),[j,x]=e.useState([]),[g,N]=e.useState(""),[v,f]=e.useState({}),[y,b]=e.useState({}),k=localStorage.getItem("userId"),I=()=>r(!1),[w,C]=e.useState(1),[$,z]=e.useState(!0),[E,A]=e.useState(!1),M=e.useRef({hasMore:$,loadingMore:E,page:w});e.useEffect((()=>{M.current={hasMore:$,loadingMore:E,page:w}}),[$,E,w]);const P=async e=>{try{const s=localStorage.getItem("token"),t=await d.get(`https://padel-hnj9.onrender.com/api/get-comments/${a._id}?page=${e}&limit=5`,{headers:{Authorization:`Bearer ${s}`}});x(t.data.likes);const l=t.data.comments;l.length>0&&u((e=>{const s=new Set(e.map((e=>e._id))),a=l.filter((e=>!s.has(e._id)));return[...e,...a]})),z(t.data.hasMore)}catch(s){}};e.useEffect((()=>{t&&P(1)}),[t,a._id]);return s.jsxs("div",{className:"comments-section-user-post",children:[s.jsxs("button",{className:"open-comments-btn-user-post",onClick:()=>r(!0),children:[s.jsx("span",{className:"comment-icon-user-post",children:"ðŸ’¬"}),s.jsx("span",{className:"comments-count-user-post",children:a.commentsCount})]}),s.jsxs(_,{isOpen:t,onRequestClose:I,className:"comments-modal-user-post-modal",overlayClassName:"modal-overlay-user-post",ariaHideApp:!1,children:[s.jsxs("div",{className:"modal-header-user-post",children:[s.jsx("h2",{className:"modal-title-user-post",children:"comments"===o?"Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª":"Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª"}),s.jsx("button",{className:"close-modal-btn-user-post",onClick:I,children:"Ã—"})]}),s.jsxs("div",{className:"tabs-container-user-post",children:[s.jsxs("button",{className:"tab-btn-user-post "+("comments"===o?"active":""),onClick:()=>m("comments"),children:["Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª (",h.length,")"]}),s.jsxs("button",{className:"tab-btn-user-post "+("likes"===o?"active":""),onClick:()=>m("likes"),children:["Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª (",null==j?void 0:j.length,")"]})]}),s.jsx("div",{className:"modal-content-user-post",children:"comments"===o?s.jsxs(s.Fragment,{children:[s.jsxs("form",{className:"comment-input-container-user-post",onSubmit:async e=>{e.preventDefault();const s=g.trim();try{const e=localStorage.getItem("token"),t=await d.put(`https://padel-hnj9.onrender.com/api/comment/${a._id}`,{comment:s},{headers:{Authorization:`Bearer ${e}`}});u((e=>[...e,t.data.comment])),N("")}catch(t){}},children:[s.jsx("input",{type:"text",value:g,onChange:e=>N(e.target.value),placeholder:"Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§...",className:"comment-input-user-post"}),s.jsx("button",{type:"submit",className:"send-comment-btn-user-post",disabled:!g.trim(),children:s.jsx("img",{src:S,alt:"Ø¥Ø±Ø³Ø§Ù„",className:"send-icon-comment-user-post",loading:"lazy"})})]}),s.jsx("div",{className:"comments-list-user-post",children:h.length>0?h.map((e=>{var t,r,o,m,h,j,x;return s.jsxs("div",{className:"comment-container-user",children:[s.jsxs("div",{className:"comment-header-user-container",children:[s.jsx("img",{src:(null==(r=null==(t=e.userId)?void 0:t.profileImage)?void 0:r.startsWith("http"))?e.userId.profileImage:`https://padel-hnj9.onrender.com${null==(o=e.userId)?void 0:o.profileImage}`,alt:"Profile",className:"comment-avatar-user-post",loading:"lazy",onError:e=>e.target.src=l}),s.jsx(c,{className:"comment-username-user-post",to:k===e.userId._id?"/@!profile":`/@!users/${e.userId._id}`,children:null==(m=e.userId)?void 0:m.name})]}),s.jsxs("div",{className:"comment-body-user-post",children:[s.jsx("div",{className:"comment-text-container-user-post",children:s.jsx("p",{className:"comment-text-user-post",children:e.comment})}),s.jsxs("div",{className:"comment-date-user-post",children:[(null==e?void 0:e.createdAt)&&s.jsx("p",{children:p(e.createdAt).fromNow()}),s.jsx("button",{className:"reply-toggle-btn-user-post",onClick:()=>b((s=>({...s,[e._id]:!s[e._id]}))),children:y[e._id]?"Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø¯ÙˆØ¯":"Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø¯ÙˆØ¯"}),k===e.userId._id?s.jsx("button",{className:"comment-delete-btn-user-post",onClick:()=>(async e=>{try{await d.delete(`https://padel-hnj9.onrender.com/api/comment/${a._id}/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),u((s=>s.filter((s=>s._id!==e))))}catch(s){}})(e._id),children:"Ø­Ø°Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ‚"}):null]})]}),y[e._id]&&s.jsxs("div",{className:"replies-section-user-post",children:[s.jsx("div",{className:"replies-list-user-post",children:null==(h=e.replies)?void 0:h.slice(0,i[e._id]||5).map((t=>{var r,i,n,o,m,h;const j=t._doc||t;return s.jsxs("div",{className:"reply-item-user-post",children:[s.jsxs("div",{className:"reply-header-user-post",children:[s.jsx("img",{src:(null==(i=null==(r=j.userId)?void 0:r.profileImage)?void 0:i.startsWith("http"))?j.userId.profileImage:`https://padel-hnj9.onrender.com${null==(n=j.userId)?void 0:n.profileImage}`,loading:"lazy",alt:"Profile",className:"reply-avatar-user-post",onError:e=>e.target.src=l}),s.jsx(c,{className:"reply-username-user-post",to:k===(null==(o=j.user)?void 0:o._id)?"/@!profile":`/@!users/${null==(m=j.user)?void 0:m._id}`,children:null==(h=j.userId)?void 0:h.name})]}),s.jsx("p",{className:"reply-text-user-post",children:j.reply}),s.jsxs("div",{className:"reply-footer-user-post",children:[(null==j?void 0:j.createdAt)&&s.jsx("p",{children:p(j.createdAt).fromNow()}),k===j.userId._id?s.jsx("div",{className:"reply-actions-user-post",children:s.jsx("button",{className:"reply-delete-btn-user-post",onClick:()=>(async(e,s)=>{try{await d.delete(`https://padel-hnj9.onrender.com/api/reply/${a._id}/${e}/${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),u((a=>a.map((a=>a._id===e?{...a,replies:a.replies.filter((e=>e._id!==s))}:a))))}catch(t){}})(e._id,j._id),children:"Ø­Ø°Ù Ø§Ù„Ø±Ø¯"})}):null]})]},j._id)}))}),(null==(j=e.replies)?void 0:j.length)>(i[e._id]||5)&&s.jsx("button",{className:"show-more-replies-btn-user-post",onClick:()=>n((s=>({...s,[e._id]:(s[e._id]||5)+5}))),children:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø±Ø¯ÙˆØ¯"}),s.jsxs("div",{className:"reply-input-container-user-post",children:[s.jsx("input",{type:"text",value:v[e._id]||"",onChange:s=>f((a=>({...a,[e._id]:s.target.value}))),placeholder:"Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ Ù‡Ù†Ø§...",className:"reply-input-user-reply-user"}),s.jsx("button",{className:"send-reply-btn-user-post",onClick:()=>(async e=>{var s;const t=null==(s=v[e])?void 0:s.trim();if(t)try{const s=localStorage.getItem("token"),l=await d.post(`https://padel-hnj9.onrender.com/api/reply/${a._id}/${e}`,{reply:t},{headers:{Authorization:`Bearer ${s}`}});u((s=>s.map((s=>s._id===e?{...s,replies:[...s.replies,l.data.reply]}:s)))),f((s=>({...s,[e]:""})))}catch(l){}})(e._id),disabled:!(null==(x=v[e._id])?void 0:x.trim()),children:s.jsx("img",{src:S,alt:"Ø¥Ø±Ø³Ø§Ù„",className:"send-icon-reply-user-post",loading:"lazy"})})]})]})]},e._id)})):s.jsx("p",{className:"no-comments",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯"})}),$&&s.jsx("div",{className:"load-more-container-user-post",children:s.jsx("button",{className:"load-more-btn-user-post",onClick:()=>{const e=w+1;C(e),P(e)},disabled:E,children:E?"Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª"})})]}):s.jsxs("div",{className:"likes-section-user-post",children:[s.jsxs("h3",{children:["Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª (",j.length,")"]}),j.length>0?s.jsx("div",{className:"likes-list-user-post",children:j.map((e=>{var a;return s.jsxs("div",{className:"like-item-user-post",children:[s.jsx("img",{src:(null==(a=e.profileImage)?void 0:a.startsWith("http"))?e.profileImage:`https://padel-hnj9.onrender.com${e.profileImage}`,alt:"Profile",className:"like-avatar-user-post",onError:e=>e.target.src=l,loading:"lazy"}),s.jsx(c,{className:"like-username-user-post",to:k===e._id?"/@!profile":`/@!users/${e._id}`,children:e.name})]},e._id)}))}):s.jsx("p",{className:"no-likes-user-post",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª Ø¨Ø¹Ø¯"})]})})]})]})};function A(){const[a,t]=e.useState([]),[r,i]=e.useState(!0),[n,o]=e.useState(!1),[m,h]=e.useState(null),{socket:u}=N.useContext(v),[j,x]=e.useState(1),[g,y]=e.useState(!0),[b,k]=e.useState({}),[S,_]=e.useState({}),[I,w]=e.useState(null),[C,A]=e.useState(null),[M,P]=e.useState([]),B=localStorage.getItem("userId");e.useEffect((()=>{if(u)return u.on("receive_message",(e=>{P((s=>[...s,e]))})),()=>u.off("receive_message")}),[u]);const R=e.useRef({hasMore:g,loadingMore:n,page:j});e.useEffect((()=>{R.current={hasMore:g,loadingMore:n,page:j}}),[g,n,j]),e.useEffect((()=>{"Notification"in window&&"granted"!==Notification.permission&&Notification.requestPermission()}),[]);const L=e.useCallback((async e=>{try{o(!0),h(null);const s=localStorage.getItem("token"),{data:a}=await d.get(`https://padel-hnj9.onrender.com/api/get-posts?page=${e}&limit=5`,{headers:{Authorization:`Bearer ${s}`}});k((e=>({...e,...a.posts.reduce(((e,s)=>(e[s._id]=s.isLikedByCurrentUser,e)),{})}))),a.posts.length>0?(t((e=>{const s=new Set(e.map((e=>e._id))),t=a.posts.filter((e=>!s.has(e._id)));return[...e,...t]})),y(a.hasMore)):y(!1)}catch{h("ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª")}finally{i(!1),o(!1)}}),[]);e.useEffect((()=>{L(1)}),[L]),e.useEffect((()=>{const e=()=>{const{scrollTop:e,scrollHeight:s,clientHeight:a}=document.documentElement,{hasMore:t,loadingMore:l,page:r}=R.current;if(e+a>=s-5&&t&&!l){const e=r+1;x(e),L(e)}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[L]);return e.useEffect((()=>{const e=e=>{"Escape"===e.key&&A(null)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[]),r?s.jsxs("div",{className:"loading-placeholder-posts",children:[s.jsx("span",{className:"spinner-placeholder-posts"}),"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."]}):m?s.jsx("div",{className:"error-message",children:m}):s.jsx("div",{className:"post-container",children:s.jsx("div",{className:"container",children:0===a.length?s.jsx("p",{className:"no-posts",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†Ø´ÙˆØ±Ø§Øª"}):s.jsxs("div",{className:"posts-container",children:[s.jsx(z,{}),a.map((e=>{var a,r,i,n,o,m;return s.jsxs("div",{className:"post",children:[s.jsxs("div",{className:"post-header-container-profile-image-name",children:[s.jsx("img",{className:"post-profile-image",src:(null==(a=e.userId)?void 0:a.profileImage)?null==(r=e.userId)?void 0:r.profileImage:l,alt:"Profile",loading:"lazy",onError:e=>{e.target.src!==l&&(e.target.src=l)}}),s.jsxs("div",{className:"post-info-container-profile-name-Home",children:[s.jsx(c,{to:(null==(i=e.userId)?void 0:i._id)===B?"/@!profile":`/@!users/${null==(n=e.userId)?void 0:n._id}`,className:"post-username",children:s.jsx("p",{children:(null==(o=e.userId)?void 0:o.name)||"Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¬Ù‡ÙˆÙ„"})}),s.jsx("p",{className:"posted-date",children:p(e.createdAt).fromNow()})]})]}),s.jsx("p",{className:"post-text",children:e.text}),(null==(m=e.links)?void 0:m.length)>0&&s.jsx("div",{className:"links-container-post",children:e.links.map(((e,a)=>s.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"link-item-post",children:e},a)))}),e.image&&s.jsx("img",{className:"post-image",src:e.image,alt:"Post",loading:"lazy",onClick:()=>{return s=e.image,A(s);var s},onError:e=>{e.target.src!==l&&(e.target.src=l)}}),C&&s.jsxs("div",{className:"open-image-modal-post",role:"dialog","aria-modal":"true",children:[s.jsx("div",{className:"overlay",onClick:()=>A(null)}),s.jsxs("div",{className:"image-container",children:[s.jsx("img",{src:C,alt:"Open",loading:"lazy"}),s.jsx("button",{className:"close-btn",onClick:()=>A(null),"aria-label":"Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙˆØ±Ø©",children:"Ã—"})]})]}),s.jsx("div",{className:"post-footer",children:s.jsxs("div",{className:"like-button-post-container",children:[s.jsx("button",{onClick:()=>(async e=>{try{const s=localStorage.getItem("token"),{data:a}=await d.put(`https://padel-hnj9.onrender.com/api/like/${e}`,{},{headers:{Authorization:`Bearer ${s}`}});t((s=>s.map((s=>s._id===e?{...s,likes:a.likes}:s)))),k((s=>({...s,[e]:!s[e]}))),_((s=>({...s,[e]:!0}))),setTimeout((()=>{_((s=>({...s,[e]:!1})))}),700)}catch(s){}})(e._id),className:"like-button-post","aria-label":"Ø¥Ø¹Ø¬Ø§Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±",children:s.jsx(f,{size:20,color:b[e._id]?"red":"#ccc",className:S[e._id]?"animate-like":""})}),s.jsx("div",{className:"show-comments-btn",onClick:()=>w((s=>s===e._id?null:e._id)),role:"button",tabIndex:0,onKeyPress:s=>{"Enter"===s.key&&w(e._id)},"aria-expanded":I===e._id,"aria-controls":`comments-section-${e._id}`,children:s.jsx(E,{post:e,activeCommentsPost:I,id:`comments-section-${e._id}`})}),s.jsx("div",{className:"share-button-container",children:s.jsx($,{postId:e._id})})]})})]},e._id)})),!n&&!g&&s.jsx("div",{className:"no-more-posts",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª"}),n&&s.jsxs("div",{className:"loading-placeholder-posts",children:[s.jsx("span",{className:"spinner-placeholder-posts"}),"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯..."]})]})})})}function M(){return s.jsxs("div",{className:"project-bar",children:[s.jsx(A,{}),s.jsx("div",{className:"project-bar-divider",children:s.jsx(C,{})})]})}function P(){const[a,t]=e.useState(null),[r,i]=e.useState(!0),[n,o]=e.useState(null),[m,p]=e.useState(!1),[h,u]=e.useState(!1),[j,x]=e.useState("");e.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token"),s=await d.get("https://padel-hnj9.onrender.com/api/get-profile-imges",{headers:{Authorization:`Bearer ${e}`}});t(s.data.user)}catch(e){}finally{i(!1)}})()}),[]);return r?s.jsx("div",{children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."}):s.jsx("div",{className:"home-create-post-container-wrapper",children:s.jsxs("div",{className:"home-create-post",children:[s.jsxs("div",{className:"home-create-post-header",children:[s.jsx(c,{to:"/@!profile",children:s.jsx("img",{src:(null==a?void 0:a.profileImage)||l,alt:"ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ",loading:"lazy",onError:e=>{e.target.onerror=null,e.target.src=l}})}),s.jsx("div",{className:"text-box-only",children:s.jsx("textarea",{name:"text",placeholder:"Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ù†Ø´Ø±Ù‡ØŸ",onClick:()=>u(!0),readOnly:!0})})]}),s.jsxs(_,{isOpen:h,onRequestClose:()=>u(!1),className:"modal-create-post",overlayClassName:"overlay-create-post",contentLabel:"Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ± Ø¬Ø¯ÙŠØ¯",children:[s.jsx("h2",{children:"Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ± Ø¬Ø¯ÙŠØ¯"}),s.jsxs("form",{onSubmit:async e=>{var s,a;e.preventDefault(),x("");const t=e.target.text.value.trim(),l=e.target.image.files[0];if(!t)return void x("ÙŠØ±Ø¬Ù‰ Ø§Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„Ù…Ù†Ø´ÙˆØ±");const r=new FormData;/^https?:\/\/[^\s]+$/.test(t)?(r.append("links",t),r.append("text","")):(r.append("text",t),r.append("links","")),l&&r.append("image",l);try{const s=localStorage.getItem("token");await d.post("https://padel-hnj9.onrender.com/api/postusers",r,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data"}}),p(!0),e.target.reset(),o(null),u(!1)}catch(i){x((null==(a=null==(s=i.response)?void 0:s.data)?void 0:a.message)||"Ø­Ø¯Ø« Ø®Ø·Ø§Ø¡")}},className:"create-post-form",encType:"multipart/form-data",children:[s.jsx("div",{children:s.jsx("textarea",{name:"text",placeholder:"Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ù†Ø´Ø±Ù‡ØŸ"})}),j&&s.jsx("p",{className:"error-message-post-create",children:j}),s.jsxs("div",{className:"file-upload",children:[s.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:e=>o(e.target.files[0]),style:{display:"none"},id:"fileInput"}),s.jsxs("label",{htmlFor:"fileInput",className:"upload-label",children:[s.jsx(y,{}),s.jsx("span",{children:n?n.name:"Ø§Ø®ØªØ± ØµÙˆØ±Ø©"})]}),n&&s.jsxs("div",{className:"image-preview",children:[s.jsx("img",{src:URL.createObjectURL(n),alt:"Ù…Ø¹Ø§ÙŠÙ†Ø©",loading:"lazy"}),s.jsx("button",{type:"button",onClick:()=>o(null),"aria-label":"Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø©",children:"Ã—"})]})]}),s.jsxs("div",{className:"post-options",children:[s.jsx("button",{type:"submit",className:"post-publish",children:"Ù†Ø´Ø±"}),s.jsx(c,{to:"/@!upload-project",className:"upload-project-link",children:s.jsx("button",{type:"button",children:"ØªØ­Ù…ÙŠÙ„ Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯"})})]})]})]})]})})}function B(){const[a,t]=e.useState(!1),[l,r]=e.useState(!0),i=localStorage.getItem("token");return e.useEffect((()=>{i?d.get("https://padel-hnj9.onrender.com/api/site-status",{headers:{Authorization:`Bearer ${i}`}}).then((e=>{t(e.data.isDown),r(!1)})).catch((e=>{r(!1)})):r(!1)}),[i]),l?s.jsx("div",{className:"loader-home-page"}):i?a?s.jsxs("div",{className:"maintenance-page-home-page",children:[s.jsx("h2",{children:"ðŸš§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ø­Ø§Ù„ÙŠØ§Ù‹"}),s.jsx("p",{children:"Ù†Ø¹ØªØ°Ø± Ø¹Ù† Ø§Ù„Ø¥Ø²Ø¹Ø§Ø¬ØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹."})]}):s.jsxs("div",{className:"home",children:[s.jsx(k,{}),s.jsx(P,{}),s.jsx(I,{}),s.jsx(M,{})]}):s.jsx(b,{to:"/@!login",replace:!0})}p.locale("ar"),p.extend(x),_.setAppElement("#root");export{B as default};
