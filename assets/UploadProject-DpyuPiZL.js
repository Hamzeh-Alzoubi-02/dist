import{r as e,a4 as a,a5 as s,a6 as r,j as i,o as n,a7 as l,e as t}from"./index-epAGByur.js";import"./vendor-MJHYApCa.js";function o(){const[o,c]=e.useState(null),[d,p]=e.useState(!1),[u,m]=e.useState(null),[h,j]=e.useState(null),[x,g]=e.useState(null),N=a({title:s().required("الرجاء إدخال عنوان المشروع"),description:s().required("الرجاء إدخال وصف للمشروع"),link:s().required("الرجاء إدخال رابط المشروع")}),f=r({initialValues:{title:"",description:"",link:""},validationSchema:N,onSubmit:async e=>{var a,s;p(!0),m(null),j(null);try{const a=new FormData;if(a.append("image",o),a.append("title",e.title),a.append("description",e.description),a.append("link",e.link),!o)return m("يرجى تحميل صورة المشروع");if(!e.title)return m("يرجى إدخال عنوان المشروع");if(!e.description)return m("يرجى إدخال وصف للمشروع");if(!e.link)return m("يرجى إدخال رابط المشروع");const s=localStorage.getItem("token");await t.post("https://padel-hnj9.onrender.com/api/upload-project",a,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data"}}),p(!1),j("✅ تم رفع المشروع بنجاح!"),f.resetForm(),c(null),g(null)}catch(r){p(!1),m((null==(s=null==(a=null==r?void 0:r.response)?void 0:a.data)?void 0:s.message)||"حدث خطأ أثناء رفع المشروع")}}});return e.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token");await t.get("https://padel-hnj9.onrender.com/api/get-projects",{headers:{Authorization:`Bearer ${e}`}})}catch(e){}})()}),[]),i.jsxs("div",{className:"upload-container-upload-project",children:[i.jsx(n,{}),i.jsx("div",{className:"background-overlay"}),i.jsx("h2",{className:"upload-header-upload-project",children:"✦ رفع مشروع جديد"}),i.jsxs("form",{onSubmit:f.handleSubmit,className:"form-container-upload-project",children:[i.jsxs("div",{className:"input-container",children:[i.jsxs("div",{className:"input-wrapper-title-upload",children:[i.jsx("input",{type:"text",name:"title",placeholder:"عنوان المشروع",onChange:f.handleChange,onBlur:f.handleBlur,value:f.values.title,className:f.touched.title&&f.errors.title?"input-error":"input"}),i.jsx("i",{className:"fas fa-heading icon"})]}),f.touched.title&&f.errors.title&&i.jsx("p",{className:"error-message",children:f.errors.title})]}),i.jsxs("div",{className:"input-container",children:[i.jsxs("div",{className:"input-wrapper-description-upload",children:[i.jsx("textarea",{name:"description",placeholder:"وصف المشروع",onChange:f.handleChange,onBlur:f.handleBlur,value:f.values.description,className:f.touched.description&&f.errors.description?"input-error":"input"}),i.jsx("i",{className:"fas fa-align-left icon"})]}),f.touched.description&&f.errors.description&&i.jsx("p",{className:"error-message",children:f.errors.description})]}),i.jsxs("div",{className:"input-container",children:[i.jsxs("div",{className:"input-wrapper",children:[i.jsx("input",{type:"text",name:"link",placeholder:"رابط المشروع (GitHub أو رابط مباشر)",onChange:f.handleChange,onBlur:f.handleBlur,value:f.values.link,className:f.touched.link&&f.errors.link?"input-error":"input"}),i.jsx("i",{className:"fas fa-link icon"})]}),f.touched.link&&f.errors.link&&i.jsx("p",{className:"error-message",children:f.errors.link})]}),i.jsxs("div",{className:"file-upload",children:[i.jsxs("label",{children:[i.jsx(l,{style:{color:"green"},size:50}),i.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const a=e.target.files[0];a&&(c(a),g(URL.createObjectURL(a)))},className:"file-input"}),i.jsx("span",{className:"file-name-upload",children:"اختر صورة لتمثيل المشروع"})]}),o&&i.jsx("p",{className:"file-name",children:o.name}),x&&i.jsx("div",{className:"preview-container",children:i.jsx("img",{src:x,alt:"معاينة الصورة",className:"preview-image-upload-project",loading:"lazy"})})]}),i.jsxs("div",{className:"status-message",children:[u&&i.jsxs("p",{className:"error-message",children:["❌ ",u]}),h&&i.jsx("p",{className:"success-message",children:h})]}),i.jsx("button",{type:"submit",disabled:d||!o,className:d?"button-disabled":"button-submit",children:d?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-spinner fa-spin"}),"جاري رفع المشروع..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-upload"}),"نشر المشروع"]})})]})]})}export{o as default};
