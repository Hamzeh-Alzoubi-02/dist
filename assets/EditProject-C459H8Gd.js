import{$ as e,u as t,r as a,j as i,a7 as s,e as n}from"./index-epAGByur.js";import"./vendor-MJHYApCa.js";const c=()=>{const{id:c}=e(),l=t(),o=localStorage.getItem("token"),[r,j]=a.useState(!0),[p,m]=a.useState(""),[d,h]=a.useState(""),[g,u]=a.useState(""),[x,v]=a.useState([]),[N,b]=a.useState(!1),[y,f]=a.useState(""),[k,w]=a.useState([]),[C,S]=a.useState(""),[z,O]=a.useState(null),[L,R]=a.useState(!1);a.useEffect((()=>{if(!c)return;(async()=>{try{const e=(await n.get(`https://padel-hnj9.onrender.com/api/project-details/${c}`,{headers:{Authorization:`Bearer ${o}`}})).data;m(e.projectName||""),S(e.ImgProjects||""),h(e.projectDescription||""),u(e.goals?e.goals.join(","):""),v(e.techStack||[]),b(e.isPublic||!1),f(e.media?e.media.join(","):""),w(e.members||[])}catch(e){}finally{j(!1)}})()}),[c]);return r?i.jsxs("div",{style:{textAlign:"center",marginTop:"50px"},children:[i.jsx("div",{className:"loader-container-edit-project-joint"}),i.jsx("p",{children:"جاري تحميل المشروع..."})]}):i.jsxs("div",{className:"modern-edit-container-project-joint",children:[i.jsxs("div",{className:"edit-header-container-project-joint",children:[i.jsx("h1",{className:"edit-title-project-joint",children:"تعديل المشروع"}),i.jsx("div",{className:"header-actions-container-project-joint",children:i.jsx("button",{className:"preview-button-project-joint",onClick:()=>R(!0),children:"معاينة التعديلات"})})]}),i.jsxs("div",{className:"edit-grid-container-project-joint",children:[i.jsxs("div",{className:"form-section-container-project-joint",children:[i.jsxs("div",{className:"input-group-title-project-joint",children:[i.jsx("label",{className:"input-label-large-project-joint",children:"عنوان المشروع"}),i.jsx("input",{type:"text",value:p,onChange:e=>m(e.target.value),className:"modern-input-project-joint-project-joint",placeholder:"أدخل عنواناً جذاباً"})]}),i.jsxs("div",{className:"input-group-title-project-joint",children:[i.jsx("label",{className:"input-label-large-project-joint",children:"وصف المشروع"}),i.jsx("textarea",{value:d,onChange:e=>h(e.target.value),className:"modern-input-project-joint-project-joint",rows:"4",placeholder:"وصف مفصل عن أهداف المشروع وطريقة العمل..."})]}),i.jsxs("div",{className:"input-group-title-project-joint",children:[i.jsx("label",{className:"input-label-large-project-joint",children:"الأهداف الرئيسية"}),i.jsx("input",{type:"text",value:g,onChange:e=>u(e.target.value),className:"modern-input-project-joint-project-joint",placeholder:"أهداف مفصولة بفواصل (هدف 1, هدف 2,...)"})]})]}),i.jsxs("div",{className:"form-section-container-project-joint",children:[i.jsxs("div",{className:"input-group-title-project-joint",children:[i.jsx("label",{className:"input-label-large-project-joint",children:"التقنيات المستخدمة"}),i.jsxs("div",{className:"tech-stack-container-project-joint",children:[x.map(((e,t)=>i.jsxs("div",{className:"tech-item",children:[i.jsx("input",{type:"text",value:e,onChange:e=>{const a=[...x];a[t]=e.target.value,v(a)},className:"modern-input-project-joint-project-joint small"}),i.jsx("button",{className:"remove-tech-btn-project-joint",onClick:()=>v(x.filter(((e,a)=>a!==t))),children:"×"})]},t))),i.jsx("button",{className:"add-tech-btn-project-joint",onClick:()=>v([...x,""]),children:"+ إضافة تقنية"})]})]}),i.jsxs("div",{className:"input-group-title-project-joint",children:[i.jsx("label",{className:"input-label-large-project-joint",children:"إعدادات الرؤية"}),i.jsx("div",{className:"visibility-toggle-container-project-joint",children:i.jsxs("label",{className:"toggle-label-project-joint",children:["مشروع عام",i.jsx("input",{type:"checkbox",checked:N,onChange:e=>b(e.target.checked),className:"toggle-input-project-joint"})]})})]})]})]}),i.jsxs("div",{className:"media-section-project-joint",children:[i.jsx("h3",{className:"section-title-project-joint",children:"الوسائط المتعددة"}),i.jsx("div",{className:"media-input-group-title-project-joint",children:i.jsx("input",{type:"text",value:y,onChange:e=>f(e.target.value),className:"modern-input-project-joint-project-joint",placeholder:"روابط الوسائط (مفصولة بفواصل)"})})]}),i.jsxs("div",{className:"members-section",children:[i.jsx("h3",{className:"section-title-project-joint",children:"فريق العمل"}),i.jsxs("div",{className:"members-grid-project-joint",children:[k.map(((e,t)=>i.jsxs("div",{className:"member-card-project-joint",children:[i.jsxs("div",{className:"member-header-project-joint",children:[i.jsxs("span",{className:"member-number-project-joint",children:["عضو #",t+1]}),i.jsx("button",{className:"delete-member-btn",onClick:()=>w(k.filter(((e,a)=>a!==t))),children:"حذف"})]}),i.jsxs("div",{className:"member-content-project-joint",children:[i.jsx("input",{type:"text",placeholder:"اسم العضو",value:e.name,onChange:e=>{const a=[...k];a[t].name=e.target.value,w(a)},className:"modern-input-project-joint-project-joint small"}),i.jsx("input",{type:"text",placeholder:"رابط البروفايل",value:e.link,onChange:e=>{const a=[...k];a[t].link=e.target.value,w(a)},className:"modern-input-project-joint-project-joint small"}),i.jsxs("div",{className:"image-upload-container-project-joint",children:["string"==typeof e.image&&""!==e.image&&!e.preview&&i.jsx("img",{className:"member-image-preview",src:e.image.replace(/\\/g,"/"),alt:"صورة العضو",loading:"lazy"}),e.preview&&i.jsx("img",{src:e.preview,alt:"معاينة العضو",className:"member-image-preview-new",loading:"lazy"}),i.jsxs("label",{className:"file-upload-label",children:[i.jsx(s,{size:24,style:{color:"green"}}),i.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(!a)return;const i=[...k];i[t].image=a,i[t].preview=URL.createObjectURL(a),w(i)},style:{display:"none"},className:"hidden-file-input"})]}),("string"==typeof e.image||e.preview)&&i.jsx("button",{className:"remove-image-btn-project-joint",onClick:()=>{const e=[...k];e[t].preview&&URL.revokeObjectURL(e[t].preview),e[t].image="",e[t].preview="",w(e)},children:"حذف الصورة"})]})]})]},t))),i.jsx("button",{className:"add-member-btn-project-joint",onClick:()=>w([...k,{name:"",link:"",image:""}]),children:"+ عضو جديد"})]})]}),i.jsxs("div",{className:"cover-image-section",children:[i.jsx("h3",{className:"section-title-project-joint",children:"صورة الغلاف"}),i.jsxs("div",{className:"cover-image-container",children:[i.jsxs("div",{className:"image-preview-wrapper",children:[!z&&C&&i.jsx("img",{className:"cover-image-preview",src:C.replace(/\\/g,"/"),alt:"صورة الغلاف الحالية",loading:"lazy"}),z&&i.jsx("img",{className:"cover-image-preview",src:URL.createObjectURL(z),alt:"معاينة الصورة الجديدة",loading:"lazy"})]}),i.jsxs("label",{className:"cover-upload-label",children:[i.jsx(s,{style:{color:"green"},size:50}),i.jsx("input",{type:"file",accept:"image/*",onChange:e=>O(e.target.files[0]),className:"hidden-file-input",style:{display:"none"}})]})]})]}),L&&i.jsx("div",{className:"confirmation-modal-overlay-project-joint",children:i.jsxs("div",{className:"confirmation-modal-project-joint",children:[i.jsxs("div",{className:"modal-header-project-joint",children:[i.jsx("h3",{children:"تأكيد التعديلات"}),i.jsx("button",{className:"close-modal-btn-project-joint",onClick:()=>R(!1),children:"×"})]}),i.jsxs("div",{className:"modal-body-project-joint",children:[i.jsx("p",{children:"هل أنت متأكد من رغبتك في حفظ التعديلات؟"}),i.jsxs("div",{className:"modal-actions-project-joint",children:[i.jsx("button",{className:"confirm-btn-project-joint",onClick:async()=>{try{const e=new FormData;e.append("title",p),e.append("description",d),e.append("goals",JSON.stringify(g.split(",").map((e=>e.trim())))),e.append("isPublic",N),e.append("media",JSON.stringify(y.split(",").map((e=>e.trim())))),e.append("techStack",JSON.stringify(x));const t=k.map((e=>({name:e.name,link:e.link,image:"string"==typeof e.image?e.image:""})));e.append("members",JSON.stringify(t)),k.forEach((t=>{t.image instanceof File&&e.append("memberImages",t.image)})),z?e.append("coverImage",z):C&&e.append("coverImagePath",C),await n.put(`https://padel-hnj9.onrender.com/api/update-join-project/${c}`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o}`}}),l("/@!Projects")}catch(e){}finally{R(!1)}},children:"نعم، حفظ التغييرات"}),i.jsx("button",{className:"cancel-btn-project-joint",onClick:()=>R(!1),children:"إلغاء"})]})]})]})})]})};export{c as default};
