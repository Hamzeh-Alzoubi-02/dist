import{r as s,j as e,o as a,ag as t,ah as i,P as n,L as c,ai as l,V as r,e as d}from"./index-epAGByur.js";import"./vendor-MJHYApCa.js";function o(){const[o,h]=s.useState([]),[m,x]=s.useState(1),[j,v]=s.useState(!0),[g,N]=s.useState(!1),[u,f]=s.useState(!0),[p,w]=s.useState(""),k=s.useRef({hasMore:j,loadingMore:g,page:m});s.useEffect((()=>{k.current={hasMore:j,loadingMore:g,page:m}}),[j,g,m]);s.useEffect((()=>{(async s=>{try{N(!0);const e=localStorage.getItem("token"),a=await d.get(`https://padel-hnj9.onrender.com/api/get-friends-ChatList?page=${s}&limit=10`,{headers:{Authorization:`Bearer ${e}`}}),t=a.data.friends;t.length>0?(h((s=>{const e=new Set(s.map((s=>s._id))),a=t.filter((s=>!e.has(s._id)));return[...s,...a]})),v(a.data.hasMore)):v(!1)}catch(e){}finally{f(!1),N(!1)}})(m)}),[m]),s.useEffect((()=>{const s=()=>{const{scrollTop:s,scrollHeight:e,clientHeight:a}=document.documentElement,{hasMore:t,loadingMore:i,page:n}=k.current;if(s+a>=e-100&&t&&!i){x(n+1)}};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)}),[]);const E=o.filter((s=>s.name.toLowerCase().includes(p.toLowerCase())));return u?e.jsx("div",{className:"loading-container-chat",children:[...Array(5)].map(((s,a)=>e.jsxs("div",{className:"friend-skeleton-chat",children:[e.jsx("div",{className:"skeleton-avatar-chat"}),e.jsxs("div",{className:"skeleton-info-chat",children:[e.jsx("div",{className:"skeleton-name-chat"}),e.jsx("div",{className:"skeleton-status-chat"})]})]},a)))}):e.jsxs("div",{className:"chat-list-container",children:[e.jsx(a,{}),e.jsxs("div",{className:"chat-list-content",children:[e.jsxs("div",{className:"chat-list-header",children:[e.jsxs("h1",{className:"chat-list-title",children:[e.jsx(t,{className:"title-icon-message"}),"دردشاتي"]}),e.jsxs("div",{className:"search-container-chat-list",children:[e.jsx(i,{className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"ابحث عن محادثة...",value:p,onChange:s=>w(s.target.value),className:"search-input-chat-list"})]})]}),u?e.jsx("div",{className:"loading-container",children:[...Array(5)].map(((s,a)=>e.jsxs("div",{className:"friend-skeleton",children:[e.jsx("div",{className:"skeleton-avatar"}),e.jsxs("div",{className:"skeleton-info",children:[e.jsx("div",{className:"skeleton-name"}),e.jsx("div",{className:"skeleton-status"})]})]},a)))}):E.length>0?e.jsxs("div",{className:"friends-list-chat-list",children:[E.map((s=>e.jsxs("div",{className:"friend-card-chat-list",children:[e.jsxs("div",{className:"friend-avatar-chat",children:[e.jsx("img",{src:s.profileImage||n,alt:s.name,loading:"lazy",onError:s=>{s.target.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ccc'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E"},className:"avatar-img-chat"}),e.jsx("div",{className:"status-indicator-chat "+(s.isOnline?"online":"offline")})]}),e.jsx("div",{className:"friend-info-chat",children:e.jsx(c,{to:`/@!users/${s._id}`,className:"friend-name",children:s.name})}),e.jsxs(c,{to:`/@!chat/${s._id}`,className:"message-button",children:[e.jsx(t,{className:"message-icon"}),e.jsx("span",{children:"مراسلة"}),e.jsx(l,{className:"chevron-icon"})]})]},s._id))),g&&e.jsxs("div",{className:"loading-more-container-chat",children:[e.jsx("div",{className:"spinner-chat"}),e.jsx("span",{children:"جاري تحميل المزيد..."})]})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx(r,{className:"empty-icon"}),e.jsx("h3",{children:"لا توجد محادثات"}),e.jsx("p",{children:"لم تقم بإضافة أصدقاء بعد أو لم تجد نتائج بحث"}),e.jsx("button",{className:"explore-button",children:e.jsx(c,{to:"/@!addfriend",children:"تصفح المستخدمين"})})]})]})]})}export{o as default};
