import{r as e,j as s,o as a,P as i,L as l,w as c,x as r,y as n,e as t,z as o,A as d,B as m}from"./index-epAGByur.js";import"./vendor-MJHYApCa.js";const v=e=>{const a=Math.floor(e),i=e%1>=.5?1:0,l=5-a-i;return s.jsxs("div",{className:"stars",children:[[...Array(a)].map(((e,a)=>s.jsx(o,{className:"star filled"},`full-${a}`))),1===i&&s.jsx(d,{className:"star half"}),[...Array(l)].map(((e,a)=>s.jsx(m,{className:"star"},`empty-${a}`)))]})};function h(){const[o,d]=e.useState({}),[m,h]=e.useState(!0),[f,p]=e.useState(null),[x,j]=e.useState([]),[N,g]=e.useState(0),[u,w]=e.useState([]),[k,b]=e.useState(!1),[y,S]=e.useState(!1),[E,M]=e.useState(1),[z,A]=e.useState(!0),[P,$]=e.useState(!1),B=e.useRef({hasMore:z,loadingMore:P,page:E});e.useEffect((()=>{B.current={hasMore:z,loadingMore:P,page:E}}),[z,P,E]),e.useEffect((()=>{(async()=>{const e=localStorage.getItem("token");try{const[s,a,i]=await Promise.all([t.get("https://padel-hnj9.onrender.com/api/profile",{headers:{Authorization:`Bearer ${e}`}}),t.get("https://padel-hnj9.onrender.com/api/get-post-by-user-count",{headers:{Authorization:`Bearer ${e}`}}),t.get("https://padel-hnj9.onrender.com/api/number-of-friends",{headers:{Authorization:`Bearer ${e}`}})]);d(s.data.user),j(a.data.post),g(i.data.numberOfFriends)}catch(s){p("فشل في جلب البيانات")}finally{h(!1)}})()}),[]);const C=async e=>{try{$(!0);const s=localStorage.getItem("token"),a=(await t.get(`https://padel-hnj9.onrender.com/api/get-user-by-user-rate?page=${e}&limit=5`,{headers:{Authorization:`Bearer ${s}`}})).data.ratings;a.length>0?(w((e=>{const s=new Set(e.map((e=>e._id))),i=a.filter((e=>!s.has(e._id)));return[...e,...i]})),a.length<5&&A(!1)):A(!1),b(!0)}catch(s){}finally{$(!1)}};e.useEffect((()=>{const e=()=>{const{scrollTop:e,scrollHeight:s,clientHeight:a}=document.documentElement,{hasMore:i,loadingMore:l,page:c}=B.current;if(e+a>=s-1&&i&&!l){const e=c+1;M(e),C(e)}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[]);const I=(e=>{if(!e||0===e.length)return 0;return e.reduce(((e,s)=>e+s.rating),0)/e.length})(u),D=()=>{S(!y)};if(m)return s.jsxs("div",{className:"loading-container-profile-user",children:[s.jsx("div",{className:"spinner-container-profile-user"}),s.jsx("span",{children:"جاري التحميل البيانات"})]});return s.jsxs("div",{className:"profile-container-view",children:[s.jsx(a,{}),s.jsxs("div",{className:"profile-container-view-content",children:[s.jsxs("div",{className:"cover-section-view-container-profile",children:[s.jsx("div",{className:"cover-section-view-gradient"}),o.coverImage&&s.jsx("img",{className:"cover-image-view-image-profile",src:o.coverImage,alt:"Cover",loading:"lazy"}),s.jsxs("div",{className:"profile-image-view-container-profile",children:[s.jsxs("div",{className:"profile-image-wrapper",children:[s.jsx("img",{onClick:D,className:"profile-image-view-image",src:(null==o?void 0:o.profileImage)||i,alt:"Profile",loading:"lazy",onError:e=>{e.target.onerror=null,e.target.src=i}}),s.jsx("div",{className:"profile-image-view-glow"})]}),y&&s.jsx("div",{className:"profile-image-view-modal",onClick:D,children:s.jsxs("div",{className:"profile-image-view-modal-content",children:[s.jsx("img",{className:"profile-image-view-modal-image",src:o.profileImage||i,alt:"Profile",loading:"lazy",onError:e=>{e.target.src=i}}),s.jsx("span",{className:"profile-image-view-modal-close",onClick:D,children:"×"})]})})]})]}),s.jsxs("div",{className:"profile-content-view-container",children:[s.jsxs("div",{className:"name-title-section-view-container",children:[s.jsx("h1",{className:"name-view-profile",children:o.name}),s.jsxs("div",{className:"link-view-profile-info-item-container",children:[s.jsxs(l,{to:"/@!PostsUsers",className:"profile-link",children:[s.jsx("i",{className:"fas fa-newspaper"})," عرض المنشورات"]}),s.jsxs(l,{to:"/@!ProjectsUser",className:"profile-link",children:[s.jsx("i",{className:"fas fa-project-diagram"})," عرض المشاريع"]}),s.jsxs(l,{to:"/@!Friends",className:"profile-link",children:[s.jsx("i",{className:"fas fa-user-friends"})," عرض الاصدقاء"]}),s.jsxs(l,{to:"/@!Projects",className:"profile-link",children:[s.jsx("i",{className:"fas fa-code-branch"})," عرض مشاريعي المشتركة"]})]}),s.jsx("div",{className:"occupation-container-view-profile",children:(o.occupation&&o.occupation.length>0?o.occupation:[""]).map(((e,a)=>s.jsx("div",{className:"occupation-box",children:e},a)))}),s.jsxs("div",{className:"rating-display",children:[s.jsx("div",{className:"rating-value",children:I.toFixed(1)}),s.jsx("div",{className:"stars-view-profile",onClick:()=>C(1),children:u.length>0?v(I):s.jsx("span",{className:"show-ratings-link",children:"عرض مستوى التقييم"})})]})]}),s.jsx("div",{className:"stats-grid-view-container-profile",children:[{title:"منشورات",value:x,icon:"fas fa-file-alt"},{title:"اصدقاء",value:N,icon:"fas fa-users"},{title:"المستوى",value:(L=o.level,{"Senior Dev":"مطور خبير","Mid-Level Dev":"مطور متوسط","Junior Dev":"مطور مبتدئ",Beginner:"مبتدئ تمامًا"}[L]||"غير محدد"),icon:"fas fa-level-up-alt"},{title:"تقييم",value:I.toFixed(1)||"—",icon:"fas fa-star"}].map(((e,a)=>s.jsxs("div",{className:"stats-grid-item-view-profile",children:[s.jsx("div",{className:"stats-grid-item-icon",children:s.jsx("i",{className:e.icon})}),s.jsx("div",{className:"stats-grid-item-value-view",children:e.value}),s.jsx("div",{className:"stats-grid-item-title-view",children:e.title})]},a)))}),s.jsxs("div",{className:"main-content-view",children:[s.jsxs("div",{className:"profile-column",children:[s.jsxs("div",{className:"about-card-view",children:[s.jsxs("h2",{className:"about-card-title-view",children:[s.jsx("i",{className:"fas fa-info-circle"})," نظرة عامة"]}),s.jsx("p",{className:"about-card-description-view",children:o.AboutMe||"لا يوجد نظرة عامة"})]}),s.jsxs("div",{className:"experience-timeline-view",children:[s.jsxs("h2",{className:"experience-timeline-title-view",children:[s.jsx(c,{id:"rocket-icon"})," الخبرات"]}),s.jsx("div",{className:"timeline-view",children:o.workExperience?s.jsxs("div",{className:"timeline-item-view",children:[s.jsx("div",{className:"timeline-dot-view"}),s.jsx("div",{className:"timeline-content-view",children:o.workExperience})]}):s.jsx("div",{className:"no-experience-view",children:s.jsx("p",{children:"لا يوجد خبرات"})})})]})]}),s.jsxs("div",{className:"profile-column",children:[s.jsxs("div",{className:"contact-card-view",children:[s.jsxs("h2",{className:"contact-card-title-view",children:[s.jsx(r,{id:"contact-icon"})," معلومات التواصل"]}),s.jsx("div",{className:"contact-card-info-view",children:[{label:"ألبريد الإلكتروني",value:o.email||"لا يوجد",icon:"fas fa-envelope"},{label:"رقم الجوال",value:o.phoneNumber||"لا يوجد",icon:"fas fa-phone"},{label:"البلد",value:o.country||"لا يوجد",icon:"fas fa-globe-asia"},{label:"تاريخ الميلاد",value:o.birthday?new Date(o.birthday).toLocaleDateString():"لا يوجد",icon:"fas fa-birthday-cake"}].map(((e,a)=>s.jsxs("div",{className:"contact-card-info-item-view",children:[s.jsx("i",{className:e.icon}),s.jsxs("div",{className:"contact-info-text",children:[s.jsxs("span",{className:"contact-label",children:[" ",e.label," : "]}),s.jsx("span",{className:"contact-card-info-item-value-view",children:e.value||"لا يوجد"})]})]},a)))})]}),o.skills&&s.jsxs("div",{className:"skills-grid-view",children:[s.jsxs("h2",{className:"skills-grid-title-view",children:[s.jsx(n,{id:"skills-icon"})," المهارات"]}),s.jsx("div",{className:"skills-grid-items-view",children:o.skills&&o.skills.length>0?o.skills.map(((e,a)=>s.jsx("div",{className:"skills-grid-item-view",children:e.trim()},a))):s.jsx("div",{className:"no-skills-view",children:s.jsx("p",{children:"لا يوجد مهارات"})})})]})]})]}),s.jsxs("div",{className:"feedback-container-view-profile",children:[s.jsxs("div",{className:"feedback-header",children:[s.jsx("h2",{children:"التقييمات"}),!k&&s.jsx("button",{onClick:()=>C(1),className:"show-ratings-btn-view",children:"عرض التقييمات"})]}),k&&s.jsxs("div",{className:"feedback-list-view-profile",children:[(null==u?void 0:u.length)>0?u.map((e=>s.jsx("div",{className:"feedback-item-view-profile",children:s.jsxs("div",{className:"feedback-content-view-profile",children:[s.jsx("p",{className:"feedback-skill-view-profile",children:e.skill}),s.jsx("div",{className:"feedback-rating-view-profile",children:v(e.rating)})]})},e._id))):s.jsx("p",{className:"no-ratings",children:"لا توجد تقييمات حالياً"}),P&&s.jsxs("div",{className:"loading-more",children:[s.jsx("div",{className:"small-spinner"}),s.jsx("span",{children:"جاري تحميل المزيد..."})]})]})]})]})]})]});var L}export{h as default};
